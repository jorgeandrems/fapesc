{% extends "FapescTutorialBundle:Fapesc:info.html.twig" %}

{% block title "Empenho de Recursos - Diária" %}

{% block content %}
<script type="text/javascript">
    jQuery(function($){
        $(".data").mask("99/99/9999");
        $("#cpf").mask("999.999.999-99");
        $("#valor").priceFormat({ prefix: '', centsSeparator: ',', thousandsSeparator: '.' });
    });
    function calcula() {
        var tabela = new Array();
        tabela[11] = 11000;
        tabela[12] = 15300;
        tabela[13] = 20000;
        tabela[21] = 5500;
        tabela[22] = 0;
        tabela[23] = 0;
        var indice;
        indice = $("#tipo").val() + $("#destino").val();
        $("#valor").val($("#quantidade").val().replace(/[^0-9]+/g,"") * tabela[indice]).priceFormat({prefix: '', centsSeparator: ',', thousandsSeparator: '.'});
        return true;
    }
    $.validator.addMethod('minStrict', function (value, el, param) {
        return parseInt(value.replace(/[^0-9]+/g,"")) >= param;        
    });
    $.validator.addMethod('minField', function (value, el, param) {
        return parseInt(value) >= parseInt($(param).val());
    });
    $(document).ready(function(){
        $("#quantidade").keyup(function(){
            $("#quantidade").val($("#quantidade").val().replace(/[^0-9]+/g,""));
            calcula();
            $("form").validate().element("#documentos");
        });
        $("#documentos").keyup(function(){
            $("#documentos").val($("#documentos").val().replace(/[^0-9]+/g,""));
        });
        $(".trigger").change(function(){
            calcula();
            $("form").validate().element("#valor");
        });
        $("form").validate({
            rules: {
                beneficiario: "required",
                cpf: "required",
                instituicao: "required",
                objetivos: "required",
                roteiro: "required",
                resultados: "required",
                inicio: "required",
                fim: "required",
                quantidade: "required",
                valor: {
                    minStrict: 5500
                },
                documentos: {
                    minField: "#quantidade"
                }
            },
            messages: {
                beneficiario: "Digite o beneficiário",
                cpf: "Digite o CPF",
                instituicao: "Digite a instituição",
                objetivos: "Digite os objetivos",
                roteiro: "Digite o roteiro",
                resultados: "Digite os resultados",
                inicio: "Digite a data de início",
                fim: "Digite a data de fim",
                quantidade: "Digite a quantidade de diárias",
                valor: {
                    minStrict: "Não é possivel cadastrar diárias para Auxiliar Técnico para Fora do Estado ou Exterior"
                },
                documentos: {
                    minField: "O número de documentos não pode ser menor que a quantidade de diárias"
                }
            }
        });
    });
</script>
<div id="content">
    <div id="sidebar">
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec magna magna, porttitor a ornare quis, interdum quis massa. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. <br /><br />Integer in commodo tellus. Suspendisse lobortis lacinia felis, ut laoreet ipsum posuere sed. Ut placerat volutpat luctus. <br /><br />Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Donec velit diam, tincidunt sed ultricies vel, scelerisque et ligula.</p>
    </div><!-- #sidebar -->
    <div id="main-content">
        <h1>:: Empenho de Recursos - Diária</h1>
        <form class="form-container" action="{{ path('relatorioEmpenhoDiariaPost', { 'idRelatorio': idRelatorio, 'idEmpenho': idEmpenho }) }}" method="POST">
            <table class="form">
                <tr>
                    <td>Beneficiário:<br /><input type="text" name="beneficiario" value="{{ beneficiario }}" /></td>
                    <td>CPF:<br /><input type="text" id="cpf" name="cpf" value="{{ cpf }}" /></td>
                </tr>
                <tr>
                    <td>Instituição:<br /><input type="text" name="instituicao" value="{{ instituicao }}" /></td>
                    <td>Tipo:<br />
                        <select class="trigger" id="tipo" name="tipo">
                            {% for item in tipoSelect %}
                            <option value="{{ item.value }}" {% if item.value == tipo %} selected="selected" {% endif %}>{{ item.text }}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>Objetivos:<textarea name="objetivos">{{ objetivos }}</textarea></td>
                </tr>
                <tr>
                    <td>Roteiro/Itinerário:<textarea name="roteiro">{{ roteiro }}</textarea></td>
                    <td>Destino:<br />
                        <select class="trigger" id="destino" name="destino">
                            {% for item in destinoSelect %}
                            <option value="{{ item.value }}" {% if item.value == destino %} selected="selected" {% endif %}>{{ item.text }}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>Resultados Obtidos:<textarea name="resultados">{{ resultados }}</textarea></td>
                </tr>
                <tr>
                    <td>De:<br /><input type="text" class="data" name="inicio" value="{{ inicio }}" /></td>
                    <td>Até:<br /><input type="text" class="data" name="fim" value="{{ fim }}" /></td>
                    <td>Quantidade:<br /><input type="text" id="quantidade" name="quantidade" value="{{ quantidade }}" /></td>
                    <td>Valor:<br /><input type="text" id="valor" name="valor" value="{{ valor }}" readonly="readonly" /></td>
                </tr>
                <tr>
                    <td>Quantidade de documentos comprobatórios:<br /><input type="text" id="documentos" name="documentos" value="{{ documentos }}" /></td>
                </tr>
            </table>
            <table class="submit" width="90%">
                <tr>
                    <td><input type="submit" value="Salvar" title="" /></td>
                </tr>
            </table>
        </form>			
    </div><!-- #main-content -->			
</div><!-- #content -->
{% endblock %}